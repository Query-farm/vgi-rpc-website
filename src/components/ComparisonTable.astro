---
const frameworks = [
  {
    name: 'vgi-rpc',
    url: '/',
    serialization: 'Arrow IPC',
    idl: 'No (Protocol classes)',
    streaming: 'Producer + Exchange',
    typedProxies: 'Yes (mypy strict)',
    transports: 'Pipe, subprocess, Unix socket, shm, HTTP',
    highlight: true,
  },
  {
    name: 'Arrow Flight',
    url: 'https://arrow.apache.org/docs/format/Flight.html',
    serialization: 'Arrow IPC + gRPC',
    idl: 'No (fixed API)',
    streaming: 'get/put/exchange',
    typedProxies: 'No (generic client)',
    transports: 'gRPC (HTTP/2)',
    highlight: false,
  },
  {
    name: 'gRPC',
    url: 'https://grpc.io/',
    serialization: 'Protobuf',
    idl: 'Yes (.proto)',
    streaming: 'All 4 patterns',
    typedProxies: 'Partial',
    transports: 'HTTP/2',
    highlight: false,
  },
  {
    name: 'Apache Thrift',
    url: 'https://thrift.apache.org/',
    serialization: 'Thrift binary/compact',
    idl: 'Yes (.thrift)',
    streaming: 'No',
    typedProxies: 'No',
    transports: 'TCP, HTTP',
    highlight: false,
  },
  {
    name: 'ConnectRPC',
    url: 'https://connectrpc.com/',
    serialization: 'Protobuf',
    idl: 'Yes (.proto)',
    streaming: 'All 4 patterns',
    typedProxies: 'Yes',
    transports: 'HTTP/1.1 + HTTP/2',
    highlight: false,
  },
  {
    name: "Cap'n Proto",
    url: 'https://capnproto.org/',
    serialization: "Cap'n Proto",
    idl: 'Yes (.capnp)',
    streaming: 'Promise pipelining',
    typedProxies: 'No',
    transports: 'TCP',
    highlight: false,
  },
  {
    name: 'JSON-RPC',
    url: 'https://www.jsonrpc.org/',
    serialization: 'JSON',
    idl: 'No',
    streaming: 'No',
    typedProxies: 'No',
    transports: 'HTTP',
    highlight: false,
  },
];
---

<section id="comparison" class="py-20 bg-farm-cream-dark/50 dark:bg-farm-dark-card/30
  border-t border-farm-cream-dark dark:border-farm-dark-border">
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
    <h2 class="text-3xl md:text-4xl font-bold text-center
      text-farm-green-deep dark:text-farm-cream">
      Framework Comparison
    </h2>
    <p class="mt-3 text-center text-lg text-farm-text-muted dark:text-farm-text-light-muted max-w-2xl mx-auto">
      How <span class="font-mono">vgi-rpc</span> compares to other RPC frameworks.
    </p>

    <div class="mt-10 overflow-x-auto rounded-xl border border-farm-cream-dark dark:border-farm-dark-border">
      <table class="w-full text-sm">
        <thead>
          <tr class="bg-farm-cream-dark dark:bg-farm-dark-card">
            <th class="px-4 py-3 text-left font-semibold text-farm-text dark:text-farm-text-light">Framework</th>
            <th class="px-4 py-3 text-left font-semibold text-farm-text dark:text-farm-text-light">Serialization</th>
            <th class="px-4 py-3 text-left font-semibold text-farm-text dark:text-farm-text-light">IDL Required</th>
            <th class="px-4 py-3 text-left font-semibold text-farm-text dark:text-farm-text-light">Streaming</th>
            <th class="px-4 py-3 text-left font-semibold text-farm-text dark:text-farm-text-light">Typed Proxies</th>
            <th class="px-4 py-3 text-left font-semibold text-farm-text dark:text-farm-text-light">Transports</th>
          </tr>
        </thead>
        <tbody class="divide-y divide-farm-cream-dark dark:divide-farm-dark-border">
          {frameworks.map(fw => (
            <tr class:list={[
              fw.highlight
                ? 'bg-farm-green-deep/5 dark:bg-farm-green-field/10'
                : 'bg-white dark:bg-farm-dark',
            ]}>
              <td class:list={[
                'px-4 py-3 font-medium whitespace-nowrap',
                fw.highlight
                  ? 'text-farm-green-deep dark:text-farm-green-field font-bold'
                  : 'text-farm-text dark:text-farm-text-light'
              ]}>
                {fw.highlight ? (
                  <a href={fw.url}>{fw.name}</a>
                ) : (
                  <a href={fw.url} target="_blank" rel="noopener noreferrer"
                    class="hover:text-farm-green-deep dark:hover:text-farm-green-field transition-colors underline decoration-farm-cream-dark dark:decoration-farm-dark-border hover:decoration-current">
                    {fw.name}
                  </a>
                )}
              </td>
              <td class="px-4 py-3 text-farm-text-muted dark:text-farm-text-light-muted">{fw.serialization}</td>
              <td class="px-4 py-3 text-farm-text-muted dark:text-farm-text-light-muted">{fw.idl}</td>
              <td class="px-4 py-3 text-farm-text-muted dark:text-farm-text-light-muted">{fw.streaming}</td>
              <td class="px-4 py-3 text-farm-text-muted dark:text-farm-text-light-muted">{fw.typedProxies}</td>
              <td class="px-4 py-3 text-farm-text-muted dark:text-farm-text-light-muted">{fw.transports}</td>
            </tr>
          ))}
        </tbody>
      </table>
    </div>

    <p class="mt-4 text-center text-sm text-farm-text-muted dark:text-farm-text-light-muted">
      See the <a href="https://vgi-rpc-python.query.farm/comparison/"
        target="_blank" rel="noopener noreferrer"
        class="text-farm-gold hover:text-farm-gold-light transition-colors">
        detailed comparison
      </a> for an in-depth analysis of each framework.
    </p>
  </div>
</section>
